<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">

    <!-- ************ -->
    <!-- API Services -->
    <!-- ************ -->
    <preference for="\Praxigento\Core\Api\Service\Customer\Get\ById"
                type="\Praxigento\Core\Service\Customer\Get\ById"/>


    <!-- ******* -->
    <!-- API Web -->
    <!-- ******* -->
    <preference for="\Praxigento\Core\Api\Web\Customer\Get\ByIdInterface"
                type="\Praxigento\Core\Web\Customer\Get\ById"/>
    <preference for="\Praxigento\Core\Api\Web\Customer\Search\ByKeyInterface"
                type="\Praxigento\Core\Web\Customer\Search\ByKey"/>


    <!-- *** -->
    <!-- App -->
    <!-- *** -->
    <preference for="\Praxigento\Core\App\Api\Web\IAuthenticator"
                type="\Praxigento\Core\App\Api\Web\Authenticator"/>


    <!-- ******* -->
    <!-- Plugins -->
    <!-- ******* -->
    <type name="Magento\Framework\Json\DecoderInterface">
        <!-- Cut form key from REST request and add as JSON attribute (MOBI-473). -->
        <plugin name="praxigento_core_plugin"
                type="Praxigento\Core\Plugin\Framework\Json\Decoder"
                sortOrder="100" disabled="false"/>
    </type>

    <type name="Magento\Framework\Reflection\MethodsMap">
        <!-- Replace Magento mapper to get full methods map (including annotated) used in DO2JSON conversion. -->
        <plugin name="praxigento_core_plugin"
                type="Praxigento\Core\Plugin\Framework\Reflection\MethodsMap"
                sortOrder="100" disabled="false"/>
    </type>

    <type name="Magento\Framework\Reflection\TypeProcessor">
        <!-- Add "\Praxigento\*" namespace to available namespaces for web service schema generation -->
        <plugin name="praxigento_core_plugin"
                type="Praxigento\Core\Plugin\Framework\Reflection\TypeProcessor"
                sortOrder="100" disabled="false"/>
    </type>

    <type name="Magento\Framework\Webapi\Rest\Request\Deserializer\Json">
        <!-- Remove from key from Web API request sent using jQuery.ajax(). -->
        <plugin name="praxigento_core_plugin"
                type="Praxigento\Core\Plugin\Framework\Webapi\Rest\Request\Deserializer\Json"
                sortOrder="100" disabled="false"/>
    </type>

    <type name="Magento\Framework\Webapi\ServiceInputProcessor">
        <!-- Process annotated methods in API data objects -->
        <plugin name="praxigento_core_plugin"
                type="Praxigento\Core\Plugin\Framework\Webapi\ServiceInputProcessor"
                sortOrder="100" disabled="false"/>
    </type>

    <type name="Magento\Framework\Webapi\ServiceOutputProcessor">
        <!-- Process annotated methods in API data objects -->
        <plugin name="praxigento_core_plugin"
                type="Praxigento\Core\Plugin\Framework\Webapi\ServiceOutputProcessor"
                sortOrder="100" disabled="false"/>
    </type>


    <!-- ***** -->
    <!-- Repos -->
    <!-- ***** -->
    <preference for="Praxigento\Core\App\Repo\Query\ISelect"
                type="Praxigento\Core\App\Repo\Query\Def\Select"/>
    <preference for="Praxigento\Core\App\Repo\IGeneric"
                type="Praxigento\Core\App\Repo\Def\Generic"/>
    <preference for="Praxigento\Core\App\Repo\Query\Criteria\IAdapter"
                type="Praxigento\Core\App\Repo\Query\Criteria\Def\Adapter"/>


    <!-- ******** -->
    <!-- REWRITES -->
    <!-- ******** -->
    <preference for="Magento\Framework\Reflection\TypeProcessor"
                type="Praxigento\Core\App\Reflection\TypeProcessor"/>


    <!-- *********** -->
    <!-- Transaction -->
    <!-- *********** -->
    <preference for="Praxigento\Core\App\Transaction\Business\IFabrique"
                type="Praxigento\Core\App\Transaction\Business\Def\Fabrique"/>
    <preference for="Praxigento\Core\App\Transaction\Business\IItem"
                type="Praxigento\Core\App\Transaction\Business\Def\Item"/>
    <preference for="Praxigento\Core\App\Transaction\Business\IManager"
                type="Praxigento\Core\App\Transaction\Business\Def\Manager"/>
    <preference for="Praxigento\Core\App\Transaction\Database\IFabrique"
                type="Praxigento\Core\App\Transaction\Database\Def\Fabrique"/>
    <preference for="Praxigento\Core\App\Transaction\Database\IItem"
                type="Praxigento\Core\App\Transaction\Database\Def\Item"/>
    <preference for="Praxigento\Core\App\Transaction\Database\IManager"
                type="Praxigento\Core\App\Transaction\Database\Def\Manager"/>

    <!-- ***** -->
    <!-- Tools -->
    <!-- ***** -->
    <preference for="Praxigento\Core\Tool\IConvert"
                type="Praxigento\Core\Tool\Def\Convert"/>
    <preference for="Praxigento\Core\Tool\IDate"
                type="Praxigento\Core\Tool\Def\Date"/>
    <preference for="Praxigento\Core\Tool\IFormat"
                type="Praxigento\Core\Tool\Def\Format"/>
    <preference for="Praxigento\Core\Tool\IPeriod"
                type="Praxigento\Core\Tool\Def\Period"/>

</config>
